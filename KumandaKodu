#include <SPI.h>
#include <nRF24L01.h>
#include <RF24.h>
/*j1_y A0
j1_x A2
j2_y A3
j2_x A4
buton_1 2
buton_2 3
buton_3 4
buzzer 6*/
struct DataPacket {
  float j1_y;
  float j1_x;
  float j2_y;
  float j2_x;
  bool b_1;//C
  bool b_2;
  bool b_3;
  bool connect;
};
RF24 radio(9, 10);
const byte address[6] = "90551";
const int buzzer = 6;
unsigned long basmaZamani = 0;
bool basiliMi = false;
void setup()
{
  pinMode(buzzer, OUTPUT);
  Serial.begin(9600);
  radio.begin();
  radio.openWritingPipe(address);
  radio.openReadingPipe(1, address);
  radio.setPALevel(RF24_PA_HIGH);
}
void loop()
{
  bool N = false;
 if (paket.b_1 == LOW) { 
    if (!basiliMi) {
      basmaZamani = millis(); 
      basiliMi = true;
    }
  } else {
    if (basiliMi && !N) {
      if (millis() - basmaZamani >= 3000) { 
        N = true;
        for (int i = 1 ; i < 10 ; i++){
          tone(buzzer, 1000);
          delay(100);
          tone(buzzer, 0);
          delay(100);
        }
      }
      basiliMi = false;
    }
  }

  DataPacket paket;
  radio.stopListening();
  paket.j1_y = analogRead(A0);
  paket.j1_x = analogRead(A2);
  paket.j2_y = analogRead(A3);
  paket.j2_x = analogRead(A4);
  paket.b_1 = digitalRead(2);
  paket.b_2 = digitalRead(3);
  paket.b_3 = digitalRead(4);
  paket.connect = N;
  radio.write(&paket, sizeof(paket));

  if (N) {N = false;}
 delay(10);
}
